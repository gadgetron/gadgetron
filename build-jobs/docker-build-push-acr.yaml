parameters:
- name: acrconnection
  type: string
- name: dockerfile
  type: string
- name: imagename
  type: string
- name: containerregistry
  type: string

steps:
- task: Docker@2
  displayName: Login to ACR
  inputs:
    command: login
    containerRegistry: ${{ parameters.acrconnection }}
- task: Docker@2
  displayName: Build and Push
  inputs:
    command: buildAndPush
    Dockerfile: ${{ parameters.dockerfile }}
    containerRegistry: ${{ parameters.acrconnection }}
    repository: ${{ parameters.containerregistry }}/${{ parameters.imagename }}
    buildContext: ./
    tags: |
      $(build.BuildNumber)
